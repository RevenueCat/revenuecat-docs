---
title: "AppsFlyer"
slug: "appsflyer"
excerpt: "Integrate Purchases SDK with AppsFlyer for precise revenue tracking"
hidden: false
metadata: 
  title: "AppsFlyer Revenue Attribution | RevenueCat"
  description: "With our AppsFlyer integration, you can accurately track subscriptions generated from AppsFlyer campaigns, allowing you to know precisely how much revenue your campaigns generate."
  image: 
    0: "https://files.readme.io/d4c092e-Reddit__E.jpg"
    1: "Reddit – E.jpg"
    2: 1200
    3: 630
    4: "#fbabaf"
createdAt: {}
updatedAt: "2020-06-17T18:09:47.398Z"
---
With our AppsFlyer integration you can:
* Accurately track subscriptions generated from AppsFlyer campaigns, allowing you to know precisely how much revenue your campaigns generate.
* Send trial conversions and renewals directly from RevenueCat to AppsFlyer, allowing for tracking without an app open.
* Continue to follow your cohorts for months to know the long tail revenue generated by your campaigns.

[block:api-header]
{
  "title": "1. Send attribution data to RevenueCat"
}
[/block]
When you receive the `onConversionDataReceived` callback you can use the `addAttributionData` method for passing the attribution data dictionary:

Use the `networkUserId` parameter to identify the attribution with the unique AppsFlyer device ID. **This parameter is required for the AppsFlyer integration to work properly.**
[block:callout]
{
  "type": "warning",
  "title": "Install the AppsFlyer SDK",
  "body": "You will need to add the AppsFlyer SDK to your app before you can connect it with RevenueCat. The integration will vary slightly depending on the Appsflyer SDK version you're using."
}
[/block]
## For apps using Appsflyer SDK version 5 and above 
[block:code]
{
  "codes": [
    {
      "code": "// IMPORTANT!! - Only use this method for version 5+ of Appsflyer SDK\n\nimport AppsFlyerLib\n\nextension AppDelegate: AppsFlyerTrackerDelegate {\n  \n    func onConversionDataSuccess(_ installData: [AnyHashable : Any]!) {\n        \n        // IMPORTANT!! - Don't forget to include the network user ID\n        Purchases.addAttributionData(installData, from: .appsFlyer, forNetworkUserId: AppsFlyerTracker.shared().getAppsFlyerUID())\n    }\n}",
      "language": "swift"
    },
    {
      "code": "// IMPORTANT!! - Only use this method for version 5+ of Appsflyer SDK\n\n#import <AppsFlyerTracker/AppsFlyerTracker.h>\n\n@interface AppDelegate : UIResponder <UIApplicationDelegate, AppsFlyerTrackerDelegate>\n- (void)onConversionDataSuccess:(NSDictionary *)installData {\n\t\t\n    // IMPORTANT!! - Don't forget to include the network user ID\n    [RCPurchases addAttributionData:installData fromNetwork:RCAttributionNetworkAppsFlyer forNetworkUserId:[[AppsFlyerTracker sharedTracker] getAppsFlyerUID]];\n}\n\n@end",
      "language": "objectivec"
    },
    {
      "code": "// IMPORTANT!! - Only use this method for version 5+ of Appsflyer SDK\n\n@Override\npublic void onConversionDataSuccess(Map<String, Object> conversionData) {\n  \n  // IMPORTANT!! - Don't forget to include the network user ID\n  Purchases.addAttributionData(conversionData, Purchases.AttributionNetwork.APPSFLYER, AppsFlyerLib.getInstance().getAppsFlyerUID(this));\n}",
      "language": "java"
    },
    {
      "code": "// IMPORTANT!! - Only use this method for version 5+ of Appsflyer SDK\n\npublic void onConversionDataSuccess(string conversionData)\n{\n    Dictionary<string, object> conversionDataDictionary = AppsFlyer.CallbackStringToDictionary(conversionData);\n\n  // IMPORTANT!! - Don't forget to include the network user ID\n  Purchases.addAttributionData(conversionDataDictionary, Purchases.AttributionNetwork.APPSFLYER, AppsFlyer.getAppsFlyerId())\n}",
      "language": "csharp",
      "name": "Unity"
    },
    {
      "code": "window.plugins.appsFlyer.initSdk({\n\t\tdevKey: appsFlyerDevKey,\n\t\tisDebug: appsFlyerDebug,\n\t\tappId: appsFlyerAppId,\n\t\tonInstallConversionDataListener: true,\n\t}, \n\t(result) => {\n\t\t// as of AppsFlyer plugin v4.4.22, result is stringified and must be parsed before sending to RevenueCat\n\t\tconst parsedResult = JSON.parse(result);\n\t\tPurchases.addAttributionData(parsedResult.data, Purchases.ATTRIBUTION_NETWORKS.APPSFLYER, appsFlyerUID);\n\t},\n\t(error) => {\n\t\tconsole.error(\"appsFlyer initSdk error:\", error);\n\t}\n);",
      "language": "javascript",
      "name": "Cordova"
    }
  ]
}
[/block]
## For apps using Appsflyer SDK version 4 and below
[block:code]
{
  "codes": [
    {
      "code": "import AppsFlyerLib\n\nextension AppDelegate: AppsFlyerTrackerDelegate {\n  \n    func onConversionDataReceived(_ installData: [AnyHashable : Any]!) {\n        \n        // IMPORTANT!! - Don't forget to include the network user ID\n        Purchases.addAttributionData(installData, from: .appsFlyer, forNetworkUserId: AppsFlyerTracker.shared().getAppsFlyerUID())\n    }\n}",
      "language": "swift",
      "name": "Swift"
    },
    {
      "code": "#import <AppsFlyerTracker/AppsFlyerTracker.h>\n\n@interface AppDelegate : UIResponder <UIApplicationDelegate, AppsFlyerTrackerDelegate>\n- (void)onConversionDataReceived:(NSDictionary *)installData {\n\t\t\n    // IMPORTANT!! - Don't forget to include the network user ID\n    [RCPurchases addAttributionData:installData fromNetwork:RCAttributionNetworkAppsFlyer forNetworkUserId:[[AppsFlyerTracker sharedTracker] getAppsFlyerUID]];\n}\n\n@end",
      "language": "objectivec",
      "name": "Objective-C"
    },
    {
      "code": "@Override\npublic void onInstallConversionDataLoaded(Map<String, String> conversionData) {\n  \n  // IMPORTANT!! - Don't forget to include the network user ID\n  Purchases.addAttributionData(conversionData, Purchases.AttributionNetwork.APPSFLYER, AppsFlyerLib.getInstance().getAppsFlyerUID(this));\n}",
      "language": "java"
    },
    {
      "code": "this.onInstallConversionDataCanceller = appsFlyer.onInstallConversionData(\n  result => {\n    appsFlyer.getAppsFlyerUID((error, appsFlyerUID) => {\n      if (error) {\n        console.error(error);\n      } else {\n        \n        // IMPORTANT!! - Don't forget to include the network user ID\n        Purchases.addAttributionData(result.data, Purchases.ATTRIBUTION_NETWORKS.APPSFLYER, appsFlyerUID);\n      }\n    });\n  }\n);",
      "language": "javascript",
      "name": "React Native"
    }
  ]
}
[/block]

[block:callout]
{
  "type": "danger",
  "body": "Make sure to remove all client side tracking of revenue. Since RevenueCat will be sending events for all revenue actions, tracking purchases with the AppsFlyer SDK directly can lead to double counting of revenue in AppsFlyer.",
  "title": "Remove SDK Purchase Tracking"
}
[/block]

[block:api-header]
{
  "title": "2. Send RevenueCat events into AppsFlyer"
}
[/block]
After you've set up the *Purchase* SDK to send attribution data from AppsFlyer to RevenueCat, you can "turn on" the integration and configure the event names from the RevenueCat dashboard.

1. Navigate to your app in the RevenueCat dashboard and choose 'AppsFlyer' from the integrations menu
2. Add your developer key and app Ids for iOS and/or Android
3. Enter the event names that RevenueCat will send or choose the default event names
4. Select whether you want RevenueCat to report proceeds (after app store cut) or revenue (gross sales)
[block:image]
{
  "images": [
    {
      "image": [
        "https://files.readme.io/58553ef-appsflyer.png",
        "appsflyer.png",
        1650,
        3638,
        "#f8f9f9"
      ],
      "caption": "AppsFlyer configuration screen"
    }
  ]
}
[/block]

[block:callout]
{
  "type": "info",
  "title": "AppsFlyer reports events by install date",
  "body": "Under the Events view, AppsFlyer displays in-app events according to the install date of the user. This means if you select Jan 1 through Jan 8, you'll see the events that were performed by users who *installed* within the selected date range."
}
[/block]

[block:callout]
{
  "type": "success",
  "title": "You've done it!",
  "body": "You should start seeing events from RevenueCat appear in AppsFlyer"
}
[/block]