---
title: Facebook Ads
slug: facebook-ads
excerpt: Integrate Purchases SDK with Facebook Ads for precise revenue tracking
hidden: false
metadata:
  title: Facebook Ads In-App Purchase Integration – RevenueCat
  description: With our Facebook Ads integration, you can accurately track subscriptions
    generated from Facebook Ad campaigns, allowing you to know precisely how much
    revenue your campaigns generate. And more!
  image:
    0: https://files.readme.io/e3949cb-RevenueCat_Docs_OG.png
    1: RevenueCat Docs OG.png
    2: 1200
    3: 627
    4: "#f7f5f5"
createdAt: '2022-08-19T01:42:11.380Z'
updatedAt: '2022-08-19T01:42:11.380Z'
category: 640a7bf1c7bae2004235517b
---
With our Facebook Ads integration you can:
* Accurately track subscriptions generated from Facebook Ad campaigns, allowing you to know precisely how much revenue your campaigns generate.
* Send trial starts, trial conversions, and renewals directly from RevenueCat to Facebook Ads Manager, allowing for accurate tracking without an app open.
* Continue to follow your cohorts for months to know the long tail revenue generated by your campaigns.

# 1. Install Facebook SDK

Before RevenueCat can integrate with Facebook, your app must be running the Facebook SDK. Refer to the [Facebook developer documentation](https://developers.facebook.com/docs/) for the latest installation instructions.

# 2. Send device data to RevenueCat

The Facebook integration requires some device-specific data. RevenueCat will only send events into Facebook Ads Manager if the below [Subscriber Attributes](doc:subscriber-attributes) keys have been set for the device.
[block:parameters]
{
  "data": {
    "h-0": "Key",
    "h-1": "Description",
    "h-2": "Required",
    "0-0": "`$idfa`",
    "1-0": "`$gpsAdId`",
    "2-0": "`$fbAnonId`",
    "3-0": "`$androidId`",
    "0-2": "✅ (iOS only)",
    "1-2": "✅ (Android only)",
    "2-2": "✅ (iOS only)",
    "3-2": "✅ (Android only)",
    "5-2": "❌ (optional)",
    "5-0": "`$ip`",
    "0-1": "iOS [advertising identifier](https://developer.apple.com/documentation/adsupport/asidentifiermanager/1614151-advertisingidentifier) UUID",
    "1-1": "Google [advertising identifier](https://developers.google.com/android/reference/com/google/android/gms/ads/identifier/AdvertisingIdClient.Info)",
    "2-1": "",
    "5-1": "The IP address of the device",
    "3-1": "Android [device identifier](https://developer.android.com/reference/android/provider/Settings.Secure#ANDROID_ID)",
    "6-0": "`$email`",
    "6-1": "The email address of the user",
    "6-2": "❌ (optional)",
    "4-0": "`$idfv`",
    "4-1": "iOS [vender identifier](https://developer.apple.com/documentation/uikit/uidevice/1620059-identifierforvendor) UUID",
    "4-2": "❌ (optional)",
    "7-0": "`$phoneNumber`",
    "7-1": "The phone number of the user",
    "7-2": "❌ (optional)"
  },
  "cols": 3,
  "rows": 8
}
[/block]
These properties can be set manually, like any other [Subscriber Attributes](doc:subscriber-attributes), or through the helper methods to `collectDeviceIdentifiers()` and `setFbAnonymousId()`.

[block:callout]
{
  "type": "danger",
  "title": "Device identifiers with iOS App Tracking Transparency (iOS 14.5+)",
  "body": "If you are requesting the App Tracking permission through ATT to access the IDFA, you can call `.collectDeviceIdentifiers()` *again* if the customer accepts the permission to update the `$idfa` attribute in RevenueCat."
}
[/block]

[block:file]
swift->code_blocks/🔌 Integrations/attribution/facebook-ads_1.swift
kotlin->code_blocks/🔌 Integrations/attribution/facebook-ads_1.kt
javascript->code_blocks/🔌 Integrations/attribution/facebook-ads_1.js
[/block]
You should make sure to set attributes after the *Purchases SDK* is configured, and before the first purchase occurs. It's safe to set this multiple times, as only the new/updated values will be sent to RevenueCat.
[block:callout]
{
  "type": "info",
  "title": "Import AdSupport Framework (iOS)",
  "body": "The AdSupport framework is required to access the IDFA parameter on iOS. Don't forget to import this into your project."
}
[/block]

[block:image]
{
  "images": [
    {
      "image": [
        "https://files.readme.io/caf9cda-Screen_Shot_2020-09-14_at_7.09.36_PM.png",
        "Screen Shot 2020-09-14 at 7.09.36 PM.png",
        649,
        155,
        "#2b292b"
      ]
    }
  ]
}
[/block]

[block:callout]
{
  "type": "danger",
  "title": "Remove Facebook SDK Purchase Tracking",
  "body": "Make sure to remove all client side tracking of revenue. Since RevenueCat will be sending events for all revenue actions, tracking purchases with the Facebook SDK directly can lead to double counting of revenue in Facebook Ads Manager.\n\nYou can disable automatic In-App Purchase event logging from the Facebook SDK or from your Facebook app dashboard. Go to the iOS/Android card under Settings > Platform > Log In-App Events Automatically > No\n\nTo continue to track install and usage events in Facebook, follow the steps in the next section."
}
[/block]
## Track Install and Usage Events

As noted above, you'll need to disable all client side tracking of revenue to prevent double counting of revenue in Facebook Ads Manager. To continue tracking install and usage events, you'll need to call Facebook's 'activate app' event after configuration:
[block:file]
swift->code_blocks/🔌 Integrations/attribution/facebook-ads_2.swift
[/block]
You can see Facebook's App Events Reference [here](https://developers.facebook.com/docs/app-events/reference).

# 3. Send RevenueCat events into Facebook Ads Manager

After you've set up the *Purchases SDK* to send attribution data to RevenueCat, you can "turn on" the integration from the RevenueCat dashboard.

1. Navigate to your project in the RevenueCat dashboard and find the *Integrations* card in the left menu. Select **+ New** 
[block:image]
{
  "images": [
    {
      "image": [
        "https://files.readme.io/4e21498-Screen_Shot_2021-12-01_at_12.23.10_PM.png",
        "Screen Shot 2021-12-01 at 12.23.10 PM.png",
        332,
        410,
        "#f5f6f5"
      ]
    }
  ]
}
[/block]
2. Choose **Facebook** from the Integrations menu.
3. Add your Facebook App ID for production events (and optionally an App ID for sandbox events).
4. Add the Facebook Client Token for your app (and for the sandbox App ID if included). You can find your Client Token in the Facebook dashboard under your **App > Settings > Advanced > Client Token**. You may need to click the 'Reset' button if there's no Client Token visible.
5. (Optional) You can toggle between different names for Facebook events.
6. Select whether you want sales reported as gross revenue (before app store commission), or after store commission and/or estimated taxes.

[block:image]
{
  "images": [
    {
      "image": [
        "https://files.readme.io/2b7eb42-Facebook_Ads.png",
        "Facebook Ads.png",
        1794,
        2101,
        "#fafafa"
      ],
      "caption": "Facebook Ads configuration screen"
    }
  ]
}
[/block]
## Event Names
RevenueCat allows you to choose from different 'Standard' Facebook event names. Using 'Standard' events is recommended by Facebook for optimizing advertising campaigns and audiences.
[block:parameters]
{
  "data": {
    "h-0": "RevenueCat Event",
    "h-1": "Recommended Facebook Event",
    "0-0": "Trial Started",
    "1-0": "Trial Converted",
    "2-0": "Initial Purchase",
    "3-0": "Renewal",
    "4-0": "Non-Renewing Purchase",
    "4-1": "Purchase",
    "3-1": "Subscribe",
    "2-1": "Subscribe",
    "1-1": "Subscribe",
    "0-1": "StartTrial"
  },
  "cols": 2,
  "rows": 5
}
[/block]
# 4. Testing the Facebook Ads Manager integration

You can test the Facebook integration end-to-end before going live. It's recommended that you test the integration is working properly for new users, and any existing users that may update their app to a new version.

## Add a sandbox App Id and sandbox Client token in the RevenueCat dashboard
Before you test the integration, make sure you have a Facebook App Id and Client Token set in the "Sandbox" fields in RevenueCat. This is required if you want the integration to trigger for sandbox purchases.

## Make a sandbox purchase with a new user
Simulate a new user installing your app, and go through your app flow to complete a sandbox purchase.

## Check that the required device data is collected
Navigate the the [Customer View](doc:customers) for the test user that just made a purchase. Make sure that all of the required data from step 1 above is listed as attributes for the user.
[block:image]
{
  "images": [
    {
      "image": [
        "https://files.readme.io/4a0a252-Screenshot_at_Sep_17_12-07-34.png",
        "Screenshot at Sep 17 12-07-34.png",
        361,
        650,
        "#f7f1f1"
      ]
    }
  ]
}
[/block]
## Check that the Facebook event delivered successfully
While still on the Customer View, click into the test purchase event in the [Customer History](doc:customer-history) and make sure that the Facebook integration event exists and was delivered successfully. 
[block:image]
{
  "images": [
    {
      "image": [
        "https://files.readme.io/3a9477e-Screen_Shot_2020-09-14_at_9.30.55_PM.png",
        "Screen Shot 2020-09-14 at 9.30.55 PM.png",
        699,
        223,
        "#f7f1f1"
      ]
    }
  ]
}
[/block]
# 5. View Events in Facebook

Once events are delivered to Facebook, they can be used across Events Manager, Ads Manager, and Audiences.
[block:callout]
{
  "type": "info",
  "body": "Note that there could be up to a 24 hour delay from when events are sent to when they are shown in the Facebook Events Manager dashboard.",
  "title": "Facebook event delay"
}
[/block]
## Events Manager
The events sent from RevenueCat will appear throughout Facebook Events Manager as 'Standard' event types. Any events sent with revenue attached will be counted toward the 'Revenue' number in Facebook. This includes trial conversions and renewals that occur when the app isn't active.
[block:image]
{
  "images": [
    {
      "image": [
        "https://files.readme.io/554d883-Screen_Shot_2021-11-09_at_5.39.40_PM.png",
        "Screen Shot 2021-11-09 at 5.39.40 PM.png",
        427,
        325,
        "#e2e2e2"
      ],
      "caption": "Revenue is sent directly into Facebook Events Manager"
    }
  ]
}
[/block]
## Advanced Matching 

RevenueCat will send customer information that you specify as subscriber attributes to Facebook. This information includes email, name, phone number, etc. Make sure the Automatic Advanced Matching toggle is turned on under your app settings. 
[block:image]
{
  "images": [
    {
      "image": [
        "https://files.readme.io/86548c3-Screen_Shot_2021-11-09_at_5.43.13_PM.png",
        "Screen Shot 2021-11-09 at 5.43.13 PM.png",
        699,
        730,
        "#f5f5f6"
      ]
    }
  ]
}
[/block]
## Ads Manager
Within Facebook Ads Manager, you can customize the display columns to include subscription specific metrics. The 'Subscriptions' and 'Trials Started' values will be updated by the 'Subscribe' and 'StartTrial' events sent by RevenueCat, respectively. 
[block:image]
{
  "images": [
    {
      "image": [
        "https://files.readme.io/c056928-Screen_Shot_2019-07-09_at_10.22.48_PM.png",
        "Screen Shot 2019-07-09 at 10.22.48 PM.png",
        528,
        842,
        "#e9e8eb"
      ]
    }
  ]
}
[/block]

[block:image]
{
  "images": [
    {
      "image": [
        "https://files.readme.io/618d096-Screen_Shot_2019-07-09_at_10.25.19_PM.png",
        "Screen Shot 2019-07-09 at 10.25.19 PM.png",
        1386,
        752,
        "#f6f4f4"
      ]
    }
  ]
}
[/block]
By tracking the subscription revenue attributed to your Facebook campaigns you can quickly spot your most effective campaigns.

## Audiences
Facebook allows you to create custom audiences based off of events. This means you can create an audience of subscribers, and even create a "Lookalike" audience for better ad targeting.

To create a custom audience off of subscribers:

1. Create a Custom Audience and select 'App activity' as the source.
[block:image]
{
  "images": [
    {
      "image": [
        "https://files.readme.io/3db1fcb-Screen_Shot_2019-07-09_at_10.30.09_PM.png",
        "Screen Shot 2019-07-09 at 10.30.09 PM.png",
        1156,
        1042,
        "#f6f4f5"
      ]
    }
  ]
}
[/block]
2. Choose an event, such as 'Subscribe' to create your audience off of.
[block:image]
{
  "images": [
    {
      "image": [
        "https://files.readme.io/c756726-Screen_Shot_2019-07-09_at_10.32.24_PM.png",
        "Screen Shot 2019-07-09 at 10.32.24 PM.png",
        1134,
        1092,
        "#f9f8f8"
      ]
    }
  ]
}
[/block]

[block:callout]
{
  "type": "success",
  "body": "You should start seeing events from RevenueCat appear in Facebook Ads Manager.",
  "title": "You've done it!"
}
[/block]