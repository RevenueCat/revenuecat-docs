---
title: "Branch"
slug: "branch"
excerpt: "Integrate Purchases SDK with Branch"
hidden: false
createdAt: "2018-12-13T18:49:53.008Z"
updatedAt: "2019-09-12T13:19:07.225Z"
---
With our Branch integration you can:
* Accurately track subscriptions generated from Branch campaigns, allowing you to know precisely how much revenue your campaigns generate.
* Send trial conversions and renewals directly from RevenueCat to Branch, allowing for tracking without an app open.
* Continue to follow your cohorts for months to know the long tail revenue generated by your campaigns.
[block:api-header]
{
  "title": "1. Set Branch user identity"
}
[/block]
In order to attach attribution data to the correct user, make sure the App User Ids for RevenueCat and Branch match. The easiest way to do this is to set the Branch SDK identity to match the *Purchases* App User Id whether you're providing your own ids or using our randomly generated ids. 

If you prefer to keep a separate user identity between Branch and RevenueCat, use the `networkUserId` parameter when adding attribution to specify the Branch user ID to attach to.
[block:callout]
{
  "type": "info",
  "title": "Install the Branch SDK",
  "body": "You will need to add the Branch SDK to your app before you can connect it with RevenueCat"
}
[/block]

[block:code]
{
  "codes": [
    {
      "code": "// login\nBranch.getInstance().setIdentity(\"my_app_user_id\")\n\n// logout\nBranch.getInstance().logout()",
      "language": "swift"
    },
    {
      "code": "// login\n[[Branch getInstance] setIdentity:@\"my_app_user_id\"];\n\n// logout\n[[Branch getInstance] logout];",
      "language": "objectivec"
    },
    {
      "code": "// login\nBranch.getInstance().setIdentity(\"my_app_user_id\");\n\n// logout\nBranch.getInstance().logout();",
      "language": "java"
    },
    {
      "code": "// login\nbranch.setIdentity(\"my_app_user_id\")\n\n// logout\nbranch.logout()",
      "language": "javascript",
      "name": "React Native"
    }
  ]
}
[/block]

[block:api-header]
{
  "title": "2. Send attribution data to RevenueCat"
}
[/block]
When initialize a `Branch` session use the `addAttributionData` method for passing the attribution data dictionary in the callback:

### Attaching attribution data to a user
[block:code]
{
  "codes": [
    {
      "code": "import Branch\n...\nBranch.getInstance().initSession(launchOptions: launchOptions) { (data, error) in\n    if let data = data {\n        Purchases.addAttributionData(data, from: .branch)\n    }\n}",
      "language": "swift",
      "name": "Swift"
    },
    {
      "code": "#import \"Branch/Branch.h\"\n...\n[[Branch getInstance] initSessionWithLaunchOptions:launchOptions\n                        andRegisterDeepLinkHandler:^(NSDictionary *data,\n                                                     NSError *error) {\n  [RCPurchases addAttributionData:data \n                         fromNetwork:RCAttributionNetworkBranch];\n}];",
      "language": "objectivec",
      "name": "Objective-C"
    },
    {
      "code": "Branch branch = Branch.getInstance(getApplicationContext());\nbranch.initSession(new BranchReferralInitListener(){\n    @Override\n    public void onInitFinished(JSONObject referringParams, BranchError error) {\n        if (error == null) {\n          Purchases.addAttributionData(referringParams, \n                                       Purchases.AttributionNetwork.BRANCH);\n        } else {\n            Log.i(\"MyApp\", error.getMessage());\n        }\n    }\n}, this.getIntent().getData(), this);",
      "language": "java"
    },
    {
      "code": "branch.subscribe(({ error, params }) => {\n  if (error) {\n    console.error('Error from Branch: ' + error)\n    return\n  }\n\n\tPurchases.addAttributionData(data, Purchases.ATTRIBUTION_NETWORKS.BRANCH)\n})",
      "language": "javascript",
      "name": "React Native"
    }
  ]
}
[/block]

[block:callout]
{
  "type": "danger",
  "body": "Make sure to remove all client side tracking of revenue. Since RevenueCat will be sending events for all revenue actions, tracking purchases with the Branch SDK directly can lead to double counting of revenue in Branch.",
  "title": "Remove SDK Purchase Tracking"
}
[/block]

[block:api-header]
{
  "title": "3.  Send RevenueCat events into Branch"
}
[/block]
After you've set up the *Purchase* SDK to send attribution data from Branch to RevenueCat, you can "turn on" the integration and configure the event tokens from the RevenueCat dashboard.

1. Navigate to your app in the RevenueCat dashboard and choose 'Branch' from the integrations menu
2. Add your test key and live key from Branch
3. Enter the event names that RevenueCat will send or choose the default event names
4. Select whether you want RevenueCat to report proceeds (after app store cut) or revenue (gross sales)
[block:image]
{
  "images": [
    {
      "image": [
        "https://files.readme.io/a3b19b2-branch.png",
        "branch.png",
        1685,
        2370,
        "#fafafa"
      ],
      "caption": "Branch configuration screen"
    }
  ]
}
[/block]

[block:callout]
{
  "type": "success",
  "title": "You've done it!",
  "body": "You should start seeing events from RevenueCat appear in Branch"
}
[/block]